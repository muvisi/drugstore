<div class="card" *ngIf="!loading">
  <div class="card-body">
    <div class="row">
      <div class="col-sm-12">
        <div class="card">
          <div class="card-header bg-primary">
            Claim headers 
            <h6 class="pull-right" style="font-size:19px;font-weight: bolder">Copay <b>{{claim?.copay | number:'1.2-2'}}/=</b></h6>
            <h6 class="pull-right" style="font-size:19px;margin-right: 12px;font-weight: bolder">Total Claim Amount <b >{{claim.amount | number:'1.2-2'}}/=</b></h6>
          </div>
          <br />
          
        <div class="row">
    
          <div class="col-sm-7 details">
            <img class="img-fluid img-circle" src="assets/img/avatars/download.png" alt="patient" style="height:180px;float: left;">
            <div class="row">
                <div class="col-sm-12 text-success">
                  <h2 style="font-weight: bolder;">{{claim.member |uppercase}}</h2>
                </div>
              </div>
            <div class="row">
              <div class="col-sm-3"><label for="">INSURANCE: </label></div>
              <div class="col-sm-9"><b>{{claim.insurance_company}}</b></div>
            </div>
            <div class="row">
              <div class="col-sm-3"><label for="">SCHEME </label></div>
              <div class="col-sm-9"><b>{{claim.scheme_name}}</b></div>
            </div>
            <div class="row">
                <div class="col-sm-3"><label>VISIT NUMBER: </label></div>
                <div class="col-sm-9"><b>{{claim.visit_number}}</b></div>
              </div>
            <div class="row">
              <div class="col-sm-3"><label for="">PATIENT NUMBER </label></div>
              <div class="col-sm-9"><b>{{claim.crno}}</b></div>
            </div>
            <div class="row">
                <div class="col-sm-3"><label for="">CHECK IN:</label></div>
                <div class="col-sm-9"><b>{{claim.check_in | date}}</b></div>
              </div>
              <div class="row">
                  <div class="col-sm-3"><label for="">CHECK OUT:</label></div>
                  <div class="col-sm-9"><b>{{claim.check_out | date}}</b></div>
                </div>
          </div>
      <div class="col-sm-4 details">
        <div class="row">
            <div class="col-sm-12">
                <button class="btn btn-info btn-sm pull-right" (click)="back()"> <i class="cui-arrow-left"></i> </button>
            </div>
        </div>
        <label><b class="text-primary">INVOICES</b></label>
        <div class="row">
          <div class="col-sm-6"  style="font-weight: bolder;font-size: 12px;" *ngFor="let item of claim.invoices"> <i class="fa fa-check text-success"></i> {{item.invoice_number}}</div>
        </div>
      </div>
         </div>
         <br />
         
        </div>
      </div>
    </div>
<div class="row">
 <div class="col-sm-12">
  <div class="card">
    <div class="card-header bg-light">
      <h5 class="text-left no-margin" style="font-size:14px;"><b>Diagnosis(ICD10)</b></h5>
    </div>
    <div class="card-body">
        <div class="row">
          <div class="col-sm-12" *ngIf="diagnoses.length">
            <div class="mat-elevation-z8 table-responsive">
              <table mat-table [dataSource]="dataSource">
            
                <!-- Position Column -->
                <ng-container matColumnDef="description">
                  <th mat-header-cell *matHeaderCellDef>Description</th>
                  <td mat-cell *matCellDef="let element"> {{element.description}} </td>
                </ng-container>
            
                <!-- Name Column -->
                <ng-container matColumnDef="code">
                  <th mat-header-cell *matHeaderCellDef>Code</th>
                  <td mat-cell *matCellDef="let element"> {{element.diagnosis_code}} </td>
                </ng-container>

                <ng-container matColumnDef="date">
                  <th mat-header-cell *matHeaderCellDef>Diagnoses Date</th>
                  <td mat-cell *matCellDef="let element"> {{element.created | date}} </td>
                </ng-container>

            
                <tr mat-header-row *matHeaderRowDef="displayedColumns"></tr>
                <tr mat-row *matRowDef="let row; columns: displayedColumns;"></tr>
              </table>
            </div>

          </div>
          <h6 *ngIf="!diagnoses.length">No ICD10 Available</h6>
        </div>
    </div>
    <div class="card-footer text-muted">
            <button class="btn btn-success btn-sm" (click)="staticModal.show()"> <i class="icon-note"></i> Code </button>
    </div>
  </div>

 </div>
  </div>
  
  
  <div *ngFor ="let section of claimSections">
 <div class="card"  *ngIf="section !== 'diagnosis'">
    <div class="card-header bg-light">
      <h5 class="text-left no-margin" style="font-size:10px;"><b>{{section | uppercase}}</b></h5>
    </div>
    <div class="card-body">
     <div class="row">
       <!-- <div class="col-sm-9">
          <table class="table table-condensed table-sm mat-elevation-z8">
            <tbody>
              <tr>
                <th>Invoice number</th>
                <th>Description</th>
                <th>Category</th>
                <th>Quantity</th>
                <th>Unit price</th>
                <th>Total price</th>
              </tr>
              <tr *ngFor="let detail of claim.claim_detail" style="color:dodgerblue">
                <td *ngIf="detail.category == section">{{ detail.invoice_number }}</td>
                <td *ngIf="detail.category == section">{{ detail.description }}</td>
                <td *ngIf="detail.category == section">{{ detail.category }}</td>
                <td *ngIf="detail.category == section">{{ detail.quantity }}</td>
                <td *ngIf="detail.category == section">{{ detail.unit_price }}</td>
                <td *ngIf="detail.category == section">{{ detail.unit_price * detail.quantity  |number }}</td>
              </tr>
          
            </tbody>
          </table>
       </div> -->
       <div class="col-sm-12">
        <table mat-table [dataSource]="claim.claim_detail" class="mat-elevation-z8">
          <ng-container matColumnDef="invoice_number">
            <th mat-header-cell *matHeaderCellDef> Invoice No. </th>
            <td mat-cell *matCellDef="let element"> {{element.invoice_number}} </td>
          </ng-container>

          <ng-container matColumnDef="description">
            <th mat-header-cell *matHeaderCellDef> Description </th>
            <td mat-cell *matCellDef="let element"> {{element.description | uppercase}} </td>
          </ng-container>
        
          <ng-container matColumnDef="category">
            <th mat-header-cell *matHeaderCellDef> Category</th>
            <td mat-cell *matCellDef="let element"> {{element.category | uppercase}} </td>
          </ng-container>
          <ng-container matColumnDef="price">
            <th mat-header-cell *matHeaderCellDef>Cost</th>
            <td mat-cell *matCellDef="let element"> {{element.unit_price}} </td>
          </ng-container>
          <ng-container matColumnDef="quantity">
            <th mat-header-cell *matHeaderCellDef>Quantity</th>
            <td mat-cell *matCellDef="let element"> {{element.quantity}} </td>
          </ng-container>
        
          <ng-container matColumnDef="total">
            <th mat-header-cell *matHeaderCellDef>Total</th>
            <td mat-cell *matCellDef="let element"> {{ element.unit_price * element.quantity |number:'1.2-2' }}</td>
          </ng-container>
          <tr mat-header-row *matHeaderRowDef="sectionsColumns"></tr>
          <tr mat-row *matRowDef="let row; columns:sectionsColumns;" [hidden]="row.category!=section"></tr>
        </table>
       </div>
     </div>
    
    </div>
 </div>
</div>
  </div>
</div>


<div class="modal fade" bsModal #staticModal="bs-modal" [config]="{backdrop: 'static'}" tabindex="-1" role="dialog"
  aria-labelledby="dialog-static-name">
  <div class="modal-dialog modal-md">
    <div class="modal-content">
      <div class="modal-body">
  <h6 style="font-size:13px;">Add Diagnosis</h6>
<div class="row">
<div class="col-sm-6">
  
<input [(ngModel)]="name" (typeaheadLoading) = "search(name)"  placeholder="Diagnosis" [typeahead]="icd" typeaheadOptionField="description" (typeaheadOnSelect)="onSelect($event)" class="form-control" type="text">
</div>
<div class="col-sm-3">
    <input type="text" placeholder="code" class="form-control" [(ngModel)]="selectedIcd.code">
</div>
<br />
<br />
</div>
  <button class="btn btn-danger btn-sm" (click)="staticModal.hide()"> Close</button>
      </div>
    </div>
    </div>

</div>
<ngx-loading [show]="loading" [config]="{ backdropBorderRadius: '9px' }"></ngx-loading>
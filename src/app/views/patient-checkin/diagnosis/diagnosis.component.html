<div *ngIf="!loading">
  <tabset>
    <tab heading="Patient Information">
        <div class="row">
            <div class="col-sm-12">
                <span style="font-size:17px;font-weight: bold" class="pull-right">FILE NO:<span  style="font-size:19px;font-weight: bold" class="text-primary" >{{patientInfo.patient_no}}</span></span>
                <span style="font-size:17px;font-weight: bold" class="pull-right">VISIT  NO:<span  style="font-size:19px;font-weight: bold;margin-right:10px;" class="text-primary" >{{patientInfo.visit_no}}</span></span>
            </div>
          </div>
      <div class="row" >
        <div class="col-sm-2">
          <mat-card>
              <h6 class="text-center">
                  <img title="profile image" class="img-circle img-responsive center" src="assets/img/avatars/download.png"
                    style="height: 115px;" *ngIf="patientInfo.gender =='Male' || patientInfo.gender =='male'">
                    <img title="profile image" class="img-circle img-responsive center" src="assets/img/avatars/female.png"style="height:105px;" *ngIf="patientInfo.gender =='Female' || patientInfo.gender =='female'">
                    <br>
                    
                  <span1 style="font-size:12px;border-radius:2px;font-weight:200px;" class="badge badge-info text-center">
                    {{patientInfo.first_name | uppercase}}
                    {{patientInfo.other_names | uppercase}} {{patientInfo.last_name | uppercase}}</span1>
                </h6>
          </mat-card>
        </div>
        <div class="col-sm-10">
            <div class="row">
                <div class="col-sm-12">
                  <mat-card> 
                    <mat-card-title>
                     <span style="font-size: 20px;">
                        <span class="text-primary" style="font-weight:600;">{{patientInfo.first_name | uppercase}} {{patientInfo.other_names | uppercase}}
                            {{patientInfo.last_name | uppercase}}</span> | <span style="font-weight: 600">
                              <span *ngIf="patientInfo?.age?.years > 0">{{patientInfo?.age?.years}}  Years</span>
                              <span *ngIf="patientInfo?.age?.months > 0">{{patientInfo?.age?.months}} Months</span>
                              <span *ngIf="patientInfo?.age?.days > 0">{{patientInfo?.age?.days}} Days</span>
                            </span>| <span class="text-primary" style="font-weight: 600">{{patientInfo?.gender}}</span> 
                     </span>
                    </mat-card-title>
                      <div class="row">
                          <div class="col-sm-6">
    
                            <div class="row">
                                <div class="col-sm-4 hx">
                                CHECK IN
                                </div>
                                <div class="col-sm-8"><span class="text-primary" style="font-weight:bold;">{{patientInfo.check_in | date}}</span></div>
                            </div>
                            <div class="row">
                                <div class="col-sm-4 hx">
                                PRIORITY
                                </div>
                                <div class="col-sm-8"><span class="text-primary" style="font-weight:bold;">{{patientInfo.priority}}</span></div>
                              </div>
                            <div class="row"> 
                              <div class="col-sm-4 hx">
                                NATIONAL ID
                              </div>
                              <div class="col-sm-8"><span class="text-primary" style="font-weight:bold;">{{patientInfo.national_id}}</span></div>
                            </div>
                            <div class="row">
                                <div class="col-sm-12">
                                    <button class="btn btn-success" *ngIf="patientInfo?.insure_check.length">COVERED</button>
                                    <button class="btn btn-danger" *ngIf="!patientInfo?.insure_check.length"> NOT COVERED</button>
                                </div>
                              </div>
                          </div>
                          <div class="col-sm-6">
                            <button mat-raised-button class="btn btn-success pull-right" (click)="closeClaim()">Close Visit</button>
                          </div>
                        </div>
                  </mat-card>
                </div>
               </div>
        </div>
      </div>
      <div class="row">
        <div class="col-sm-12">
  
          <mat-tab-group>
            <mat-tab label="Patient History">
                <div class="row container-fluid">
                    <div class="col-sm-12">
                        <br>
                              <mat-accordion>
                                  <mat-expansion-panel>
                                    <mat-expansion-panel-header>
                                      <mat-panel-title>
                                        DIAGNOSIS
                                      </mat-panel-title>
                                    </mat-expansion-panel-header>
                                        <div class="mat-elevation-z8">
                                            <table mat-table [dataSource]="patientInfo.history.diagnoses">
                                              <ng-container matColumnDef="sn">
                                                <th mat-header-cell *matHeaderCellDef>S/No</th>
                                                <td mat-cell *matCellDef="let element;let i=index"> {{i+1}} </td>
                                              </ng-container>
                                              <ng-container matColumnDef="name">
                                                <th mat-header-cell *matHeaderCellDef>Description</th>
                                                <td mat-cell *matCellDef="let element"> {{element.description}} </td>
                                              </ng-container>
                                              <ng-container matColumnDef="code">
                                                <th mat-header-cell *matHeaderCellDef>Code</th>
                                                <td mat-cell *matCellDef="let element"> {{element.code}} </td>
                                              </ng-container>
 
                                              <ng-container matColumnDef="date">
                                                <th mat-header-cell *matHeaderCellDef>Diagnosis Date</th>
                                                <td mat-cell *matCellDef="let element"> {{element.visit__check_in | date}} </td>
                                              </ng-container>
                                          
                                              <tr mat-header-row *matHeaderRowDef="historyDiagnosis"></tr>
                                              <tr mat-row *matRowDef="let row; columns: historyDiagnosis"></tr>
                                            </table>
                                          
                                          </div>
                                  </mat-expansion-panel>
                                  <mat-expansion-panel (opened)="panelOpenState = true"
                                                        (closed)="panelOpenState = false">
                                    <mat-expansion-panel-header>
                                      <mat-panel-title>
                                        PROCEDURES
                                      </mat-panel-title>
                                    
                                    </mat-expansion-panel-header>
            
                                        <div class="mat-elevation-z8">
                                            <table mat-table [dataSource]="patientInfo.history.procedures">
                                              <ng-container matColumnDef="sn">
                                                <th mat-header-cell *matHeaderCellDef>S/No</th>
                                                <td mat-cell *matCellDef="let element;let i=index"> {{i+1}} </td>
                                              </ng-container>
                                              <ng-container matColumnDef="service">
                                                <th mat-header-cell *matHeaderCellDef>Service</th>
                                                <td mat-cell *matCellDef="let element"> {{element.service}} </td>
                                              </ng-container>
                                              <ng-container matColumnDef="bill_number">
                                                <th mat-header-cell *matHeaderCellDef>Bill Number</th>
                                                <td mat-cell *matCellDef="let element"> {{element.bill_number}} </td>
                                              </ng-container>
 
                                              <ng-container matColumnDef="invoice">
                                                <th mat-header-cell *matHeaderCellDef>Invoice</th>
                                                <td mat-cell *matCellDef="let element"> {{element.invoice__no}} </td>
                                              </ng-container>
                                              <ng-container matColumnDef="cost">
                                                  <th mat-header-cell *matHeaderCellDef>Cost</th>
                                                  <td mat-cell *matCellDef="let element"> {{element.rate}} </td>
                                                </ng-container>
                                          
                                              <tr mat-header-row *matHeaderRowDef="historyServices"></tr>
                                              <tr mat-row *matRowDef="let row; columns: historyServices"></tr>
                                            </table>
                                          
                                          </div>
                                  </mat-expansion-panel>

                                  <mat-expansion-panel (opened)="panelOpenState = true"
                                                        (closed)="panelOpenState = false">
                                    <mat-expansion-panel-header>
                                      <mat-panel-title>
                                        LAB TESTS
                                      </mat-panel-title>
                                    
                                    </mat-expansion-panel-header>
                            
                                        <div class="mat-elevation-z8">
                                            <table mat-table [dataSource]="patientInfo.history.lab_tests">
                                              <ng-container matColumnDef="sn">
                                                <th mat-header-cell *matHeaderCellDef>S/No</th>
                                                <td mat-cell *matCellDef="let element;let i=index"> {{i+1}} </td>
                                              </ng-container>
                                              <ng-container matColumnDef="service">
                                                <th mat-header-cell *matHeaderCellDef>Service</th>
                                                <td mat-cell *matCellDef="let element"> {{element.service}} </td>
                                              </ng-container>
                                              <ng-container matColumnDef="bill_number">
                                                <th mat-header-cell *matHeaderCellDef>Bill Number</th>
                                                <td mat-cell *matCellDef="let element"> {{element.bill_number}} </td>
                                              </ng-container>
 
                                              <ng-container matColumnDef="invoice">
                                                <th mat-header-cell *matHeaderCellDef>Invoice</th>
                                                <td mat-cell *matCellDef="let element"> {{element.invoice__no}} </td>
                                              </ng-container>
                                              <ng-container matColumnDef="cost">
                                                  <th mat-header-cell *matHeaderCellDef>Cost</th>
                                                  <td mat-cell *matCellDef="let element"> {{element.rate}} </td>
                                                </ng-container>
                                          
                                              <tr mat-header-row *matHeaderRowDef="historyServices"></tr>
                                              <tr mat-row *matRowDef="let row; columns: historyServices"></tr>
                                            </table>
                                          
                                          </div>
                                  </mat-expansion-panel>

                                  <mat-expansion-panel (opened)="panelOpenState = true"
                                                        (closed)="panelOpenState = false">
                                    <mat-expansion-panel-header>
                                      <mat-panel-title>
                                        PRESCRIPTIONS
                                      </mat-panel-title>
                                    
                                    </mat-expansion-panel-header>
                                  
                                        <div class="mat-elevation-z8">
                                        <table mat-table [dataSource]="patientInfo.history.prescription">
                                            <ng-container matColumnDef="sn">
                                              <th mat-header-cell *matHeaderCellDef>S/No</th>
                                              <td mat-cell *matCellDef="let element;let i=index"> {{i+1}} </td>
                                            </ng-container>
                                            <ng-container matColumnDef="name">
                                              <th mat-header-cell *matHeaderCellDef>Name</th>
                                              <td mat-cell *matCellDef="let element"> {{element.service}} </td>
                                            </ng-container>
                                            <ng-container matColumnDef="generic_name">
                                              <th mat-header-cell *matHeaderCellDef>Generic Name</th>
                                              <td mat-cell *matCellDef="let element"> {{element.generic_name}} </td>
                                            </ng-container>

                                            <ng-container matColumnDef="form">
                                              <th mat-header-cell *matHeaderCellDef>Form</th>
                                              <td mat-cell *matCellDef="let element"> {{element.form}} </td>
                                            </ng-container>
                                            <ng-container matColumnDef="strength">
                                                <th mat-header-cell *matHeaderCellDef>Strength</th>
                                                <td mat-cell *matCellDef="let element"> {{element.strength}} </td>
                                              </ng-container>
                                              <ng-container matColumnDef="refils">
                                                  <th mat-header-cell *matHeaderCellDef>Refils</th>
                                                  <td mat-cell *matCellDef="let element"> {{element.refils}} </td>
                                              </ng-container>
                                              <ng-container matColumnDef="date">
                                                  <th mat-header-cell *matHeaderCellDef>Date</th>
                                                  <td mat-cell *matCellDef="let element"> {{element.created}} </td>
                                              </ng-container>
                                        
                                        
                                            <tr mat-header-row *matHeaderRowDef="historyDrugs"></tr>
                                            <tr mat-row *matRowDef="let row; columns: historyDrugs"></tr>
                                          </table>
                                          </div>
                                  </mat-expansion-panel>
                                  
                                </mat-accordion>
                        <br>
                      </div>
                </div>
            </mat-tab>
            <mat-tab label="Procedures">
              <div class="row container-fluid">
                  <div class="col-sm-12">
                      <br>
                        <button mat-raised-button class="btn btn-info btn-sm pull-right" 
                        printSectionId="proc" [useExistingCss]="true" ngxPrint [disabled]="!patientInfo.procedures.length" printTitle="{{patientInfo.visit_no}}"><i class="cui-print" style="font-size: 32px"></i></button>
                        
                    </div>
                <div class="col-sm-12">
                  
                  <br>
                  
                  <div class="mat-elevation-z8">
                    <table mat-table [dataSource]="data">
                        <ng-container matColumnDef="Sn">
                            <th mat-header-cell *matHeaderCellDef>S/No</th>
                            <td mat-cell *matCellDef="let element;let i = index"> {{i+1}} </td>
                          </ng-container>
                      <ng-container matColumnDef="Procedure">
                        <th mat-header-cell *matHeaderCellDef> Procedure. </th>
                        <td mat-cell *matCellDef="let element"> {{element.service}} </td>
                      </ng-container>
                      <ng-container matColumnDef="Category">
                        <th mat-header-cell *matHeaderCellDef> Category </th>
                        <td mat-cell *matCellDef="let element"> {{element.category}} </td>
                      </ng-container>
                      <ng-container matColumnDef="Bill Number">
                        <th mat-header-cell *matHeaderCellDef> Bill Number </th>
                        <td mat-cell *matCellDef="let element"> {{element.bill_number}} </td>
                      </ng-container>
  
  
                      <ng-container matColumnDef="Invoice">
                        <th mat-header-cell *matHeaderCellDef> Invoice Number </th>
                        <td mat-cell *matCellDef="let element"> {{element.invoice__no}} </td>
                      </ng-container>
  
  
                      <ng-container matColumnDef="Cost">
                        <th mat-header-cell *matHeaderCellDef> Cost </th>
                        <td mat-cell *matCellDef="let element"> {{element.rate}} </td>
                      </ng-container>
  
                      <ng-container matColumnDef="Quantity">
                        <th mat-header-cell *matHeaderCellDef> Quantity </th>
                        <td mat-cell *matCellDef="let element"> {{element.quantity}} </td>
                      </ng-container>
  
  
                      <ng-container matColumnDef="Status">
                        <th mat-header-cell *matHeaderCellDef>Status</th>
                        <td mat-cell *matCellDef="let element">
  
                          <span class="badge badge-success" style="border-radius:2px;font-size:10px;"
                            *ngIf="element.status=='1'"> Fully Paid</span>
                          <span class="badge badge-danger" style="border-radius:2px;font-size:10px;"
                            *ngIf="element.status=='0'"> Not Paid</span>
                        </td>
                      </ng-container>
                      <ng-container matColumnDef="delete">
                          <th mat-header-cell *matHeaderCellDef> Delete </th>
                          <td mat-cell *matCellDef="let element" (click)="deleteItem(element)"><mat-icon color="warn">delete_sweep</mat-icon></td>
                        </ng-container>
                  
                      <tr mat-header-row *matHeaderRowDef="procedureColumns"></tr>
                      <tr mat-row *matRowDef="let row; columns: procedureColumns;"></tr>
                    </table>
                    </div>
                  <br>
                  </div>
              </div>
              <div class="card" id="proc"  hidden> 
                  <div class="card-body">
                    <div class="row container-fluid">
                        <div class="col-sm-12">
                            <div class="row">
                     
                                <div class="col-sm-8">
                                    <address>
                                        <h2 style="font-family:lato light;font-weight: bolder">Kaatun Urology Center and Male Executive Clinics</h2>
                                        <span class="address" style="font-size: 18px;">
                                              <i> Parklands 3rd Avenue opposite Aga Khan Hospital</i> <br>
                                              <i > Park Medical Center,6th floor room 609</i> <br>
                                             <i> Postal address Box 15301-00100, Nairobi, Kenya</i><br>
                                            <!-- <i class="icon-call-in"></i> contact +254 7 789-1234,<br> -->
                                            <i> info@kaatun.com</i> 
                                        </span>
                                        </address>
                                </div>
                                <div class="col-sm-4">
                                    <img src="assets/img/avatars/inv_logo.jpg" style="float: right" alt="">
                                </div>
                              </div>
                        </div>
                        <div class="col-sm-12">
                          <h3 style="font-weight: bolder">INVOICE N0 : <span class="text-primary" *ngIf="patientInfo?.procedures?.length">{{patientInfo?.procedures[0]?.invoice__no}}</span></h3>
                        
                        </div>
                        
                          <div class="col-sm-5" style="font-size: 16px;">
                              <div class="row">
                                  <div class="col-sm-4">Type</div>
                                  <div class="col-sm-5">PROCEDURES</div>
                              </div>
                            <div class="row">
                              <div class="col-sm-4">Charge Date</div>
                              <div class="col-sm-5">{{ patientInfo?.check_in | date}}</div>
                            </div>
                            <div class="row">
                                <div class="col-sm-4">Net</div>
                                <div class="col-sm-5"><b>{{ proceduresAmount | number:'1.2-2'}}</b></div>
                              </div>
                             
                              <div class="row">
                                  <div class="col-sm-4">Cashier</div>
                                  <div class="col-sm-5">{{user.username}}</div>
                                </div>
                          </div>
                          <div class="col-sm-7" style="font-size: 16px;">
                              <div class="row">
                                  <div class="col-sm-4" >PATIENT</div>
                                  <div class="col-sm-5"><strong>{{patientInfo?.first_name | uppercase}} {{patientInfo?.other_names | uppercase}} {{patientInfo?.last_name | uppercase}}</strong></div>
                                </div>
                                <div class="row">
                                    <div class="col-sm-4">Visit number</div>
                                    <div class="col-sm-5">{{patientInfo?.visit_no}}</div>
                                  </div>
                                  <div class="row">
                                      <div class="col-sm-4">Gender</div>
                                      <div class="col-sm-5">{{patientInfo?.gender}}</div>
                                  </div>
                                <div class="row">
                                    <div class="col-sm-4">Phone</div>
                                    <div class="col-sm-5">{{patientInfo?.phone}}</div>
                                  </div>
                                  <!-- <div class="row">
                                      <div class="col-sm-4">Email</div>
                                      <div class="col-sm-5">davia@gmail.com</div>
                                  </div> -->
                            </div>
                            
                            <div class="col-sm-12">
                                <br>
                                <table class="table table-condensed" style="font-size: 16px;">  <tr> 
                                    <th>Item / Desc.</th>
                                    <th>Category.</th>
                                    <th>Bill Number.</th>
                                    <th>Qty.</th>
                                    <th>Cost</th>
                                    <th>Total</th>
                                    </tr> 
                                    <tr *ngFor="let item of patientInfo.procedures" style="font-weight: bolder"> 
                                    <td>{{item.service}}</td>
                                    <td >{{item.category | uppercase}}</td> 
                                    <td>{{item.bill_number}}</td>
                                    <td>{{item.quantity}}</td>
                                    <td>{{item.rate | number:'1.2-2'}}</td>
                                    <td>{{item.rate * item.quantity | number:'1.2-2'}}</td> 
                                    </tr>
                
                                    <tr>
                                    <td></td>
                                    <td></td>
                                    <td></td>
                                    <td></td>
                                    <td></td>
                                    <td></td>
                                    </tr> 
                                     </table>
                
                                  </div>
                                  <div class="col-sm-4"></div>
                                  <div class="col-sm-4"></div>
                                  <div class="col-sm-4 total" style="font-size: 19px;">
                                    <div class="row">
                                      <div class="col-sm-5"> <b>SUB TOTAL </b></div>
                                      <div class="col-sm-7 text-info">{{ proceduresAmount | number:'1.2-2' }}</div>
                                    </div>
                                    <hr>
                                    <div class="row">
                                        <div class="col-sm-5">Total Amount </div>
                                        <div class="col-sm-7">{{proceduresAmount | number:'1.2-2'}}</div>
                                      </div>
                                      
                                      <div class="row">
                                          <div class="col-sm-5">Tax </div>
                                          <div class="col-sm-7">{{0 |number:'1.2-2'}}</div>
                                      </div>
                                      <div class="row">
                                          <div class="col-sm-5"><strong class="text-success">AMOUNT DUE</strong></div>
                                          <div class="col-sm-7"><strong>{{proceduresAmount | number:'1.2-2'}}</strong></div>
                                        </div>
                                      
                                    
                                  </div>
                                  <div class="col-sm-12 footer">
                                    <div class="row">
                                      <div class="col-sm-6">
                                          powered by healthix uilabs
                                      </div>
                                      <div class="col-sm-6"><p class="pull-right"> <img src="../../../../assets/img/avatars/logo.png" style="height: 40px" alt=""> </p></div>
                                    </div>
                                  </div>
                                
                    </div>
                  </div>
                </div>
            </mat-tab>
            <mat-tab label="Diagnosis">
              <div class="row container-fluid">
                  <!-- <div class="col-sm-12">
                      <br>
                        <button mat-raised-button class="btn btn-info btn-sm pull-right" printTitle="INVOICE"
                        printSectionId="print-section" [useExistingCss]="true" ngxPrint><i class="cui-print" style="font-size: 32px"></i></button>
                    </div> -->
                <div class="col-sm-12">
                  <br>
                  <div class="mat-elevation-z8">
                    <table mat-table [dataSource]="diagnosisList">
                        <ng-container matColumnDef="Sn">
                            <th mat-header-cell *matHeaderCellDef>S/No</th>
                            <td mat-cell *matCellDef="let element; let i = index;"> {{i+1}} </td>
                          </ng-container>
                      <ng-container matColumnDef="Diagnosis">
                        <th mat-header-cell *matHeaderCellDef>Diagnosis</th>
                        <td mat-cell *matCellDef="let element"> {{element.description}} </td>
                      </ng-container>
  
                      <ng-container matColumnDef="Code">
                        <th mat-header-cell *matHeaderCellDef>Code</th>
                        <td mat-cell *matCellDef="let element"> {{element.code}} </td>
                      </ng-container>
                      <ng-container matColumnDef="Primary">
                        <th mat-header-cell *matHeaderCellDef>Primary</th>
                        <td mat-cell *matCellDef="let element"><mat-checkbox></mat-checkbox></td>
                      </ng-container>
                      <ng-container matColumnDef="delete">
                          <th mat-header-cell *matHeaderCellDef>Delete</th>
                          <td mat-cell *matCellDef="let element"> <mat-icon color="warn">delete_sweep</mat-icon></td>
                        </ng-container>
                      <tr mat-header-row *matHeaderRowDef="diagnosisColumns"></tr>
                      <tr mat-row *matRowDef="let row; columns: diagnosisColumns"></tr>
                    </table>
  
                  </div>
                  <br>
                </div>
                <div class="col-sm-4"></div>
              </div>
              <div>
              </div>
            </mat-tab>
            <mat-tab label="Medications">
              <div class="row container-fluid">
                  <div class="col-sm-12">
                      <br>
                        <button mat-raised-button class="btn btn-info btn-sm pull-right" 
                        printSectionId="pres" [useExistingCss]="true" ngxPrint [disabled]="!patientInfo.prescription.length" printTitle="{{patientInfo.visit_no}}"><i class="cui-print" style="font-size: 32px"></i></button>
                    </div>
                <div class="col-sm-12">
                  <br>
                  <div class="col-sm-12">
                      <div class="mat-elevation-z8">
                          <table mat-table [dataSource]="prescriptions">
                              <ng-container matColumnDef="generic_name">
                                  <th mat-header-cell *matHeaderCellDef>Generic Name</th>
                                  <td mat-cell *matCellDef="let element"> {{element.generic_name}} </td>
                                </ng-container>
                            <ng-container matColumnDef="name">
                              <th mat-header-cell *matHeaderCellDef>Brand Name</th>
                              <td mat-cell *matCellDef="let element"> {{element.name}} </td>
                            </ng-container>
                            
                            <ng-container matColumnDef="dosage">
                              <th mat-header-cell *matHeaderCellDef>Dosage</th>
                              <td mat-cell *matCellDef="let element"> {{element.dosage}} </td>
                            </ng-container>
                            <ng-container matColumnDef="frequency">
                              <th mat-header-cell *matHeaderCellDef>Frequency</th>
                              <td mat-cell *matCellDef="let element"> {{element.frequency}} </td>
                            </ng-container>
                            <ng-container matColumnDef="duration">
                              <th mat-header-cell *matHeaderCellDef>Duration</th>
                              <td mat-cell *matCellDef="let element"> {{element.duration}} </td>
                            </ng-container>
            
                            <ng-container matColumnDef="route">
                              <th mat-header-cell *matHeaderCellDef> Route </th>
                              <td mat-cell *matCellDef="let element"> {{element.route}} </td>
                            </ng-container>
                            <ng-container matColumnDef="notes">
                                <th mat-header-cell *matHeaderCellDef>Notes </th>
                                <td mat-cell *matCellDef="let element"> {{element.notes }} </td>
                              </ng-container>
                              <ng-container matColumnDef="form">
                                  <th mat-header-cell *matHeaderCellDef>Form</th>
                                  <td mat-cell *matCellDef="let element"> {{element.form}}</td>
                                </ng-container>
                                <ng-container matColumnDef="delete">
                                    <th mat-header-cell *matHeaderCellDef> Delete </th>
                                    <td mat-cell *matCellDef="let element" (click)="deleteItem(element)"><mat-icon color="warn">delete_sweep</mat-icon></td>
                                  </ng-container>
                            <tr mat-header-row *matHeaderRowDef="drugColumns"></tr>
                            <tr mat-row *matRowDef="let row; columns: drugColumns"></tr>
                          </table>
                        </div>
                    
                    </div>
                  <br>
                </div>
              </div>
              
              <div class="card" id="pres"  hidden> 
                  <div class="card-body">
                    <div class="row container-fluid">
                        <div class="col-sm-12">
                            <div class="row">
                     
                                <div class="col-sm-8">
                                    <address>
                                        <h2 style="font-family:lato light;font-weight: bolder">Kaatun Urology Center and Male Executive Clinics</h2>
                                        <span class="address" style="font-size: 18px;">
                                              <i> Parklands 3rd Avenue opposite Aga Khan Hospital</i> <br>
                                              <i > Park Medical Center,6th floor room 609</i> <br>
                                             <i> Postal address Box 15301-00100, Nairobi, Kenya</i><br>
                                            <!-- <i class="icon-call-in"></i> contact +254 7 789-1234,<br> -->
                                            <i> info@kaatun.com</i> 
                                        </span>
                                        </address>
                                </div>
                                <div class="col-sm-4">
                                    <img src="assets/img/avatars/inv_logo.jpg" style="float: right" alt="">
                                </div>
                              </div>
                        </div>
                        <div class="col-sm-12">
                          <h3 style="font-weight: bolder">INVOICE N0 : <span class="text-primary" *ngIf="patientInfo?.lab_test?.length">{{patientInfo?.lab_test[0]?.invoice__no}}</span></h3>
                        
                        </div>
                        
                          <div class="col-sm-5" style="font-size: 16px;">
                              <div class="row">
                                  <div class="col-sm-4">Type</div>
                                  <div class="col-sm-5">PRESCRIPTION</div>
                              </div>
                            <div class="row">
                                <div class="col-sm-4" >Patient Name</div>
                                <div class="col-sm-5"><strong>{{patientInfo?.first_name | uppercase}} {{patientInfo?.other_names | uppercase}} {{patientInfo?.last_name | uppercase}}</strong></div>
                              </div>
                              <div class="row">
                                  <div class="col-sm-4">Visit number</div>
                                  <div class="col-sm-5">{{patientInfo?.visit_no}}</div>
                                </div>
                                <div class="row">
                                    <div class="col-sm-4">Gender</div>
                                    <div class="col-sm-5">{{patientInfo?.gender}}</div>
                                </div>
                              <div class="row">
                                  <div class="col-sm-4">Phone</div>
                                  <div class="col-sm-5">{{patientInfo?.phone}}</div>
                                </div>
                          </div>
                          
                            
                            <div class="col-sm-12">
                                <br>
                                <table class="table table-condensed" style="font-size: 16px;">  <tr> 
                                    <th>Item / Desc.</th>
                                    <th>Strength</th>
                                    <th>Form</th>
                                    <th>Dosage.</th>
                                    <th>Route</th>
                                    <th>Notes</th>
                                    </tr> 
                                    <tr *ngFor="let item of patientInfo.prescription" style="font-weight: bolder"> 
                                    <td>{{item.name}}</td>
                                    <td >{{item.strength}}</td> 
                                    <td>{{item.form}}</td>
                                    <td>{{item.dosage}}</td>
                                    <td>{{item.route}}</td>
                                    <td>{{item.Notes}}</td> 
                                    </tr>
                
                                    <tr>
                                    <td></td>
                                    <td></td>
                                    <td></td>
                                    <td></td>
                                    <td></td>
                                    <td></td>
                                    </tr> 
                                     </table>
                
                                  </div>
                                  
                                  <div class="col-sm-12 footer">
                                    <div class="row">
                                      <div class="col-sm-6">
                                          powered by healthix uilabs
                                      </div>
                                      <div class="col-sm-6"><p class="pull-right"> <img src="assets/img/avatars/logo.png" style="height: 40px" alt=""> </p></div>
                                    </div>
                                  </div>
                                
                    </div>
                  </div>
                </div>
            </mat-tab>
            <mat-tab label="Labs" >
              <div class="row container-fluid">
                <br>
                
                <div class="col-sm-12">
                  <br>
                    <button mat-raised-button class="btn btn-info btn-sm pull-right" printTitle="{{patientInfo.visit_no}}"
                    printSectionId="print-section" [useExistingCss]="true" [disabled]="!patientInfo.lab_test.length" ngxPrint><i class="cui-print" style="font-size: 32px"></i></button>
                </div>
                <div class="col-sm-12">
                    <br>
                  <div class="mat-elevation-z8">
                    <table mat-table [dataSource]="patientInfo.lab_test" >
                      <ng-container matColumnDef="Sn">
                            <th mat-header-cell *matHeaderCellDef>S/No</th>
                            <td mat-cell *matCellDef="let element;let i = index"> {{i+1}} </td>
                          </ng-container>
                      <ng-container matColumnDef="Procedure">
                        <th mat-header-cell *matHeaderCellDef> Lab Test. </th>
                        <td mat-cell *matCellDef="let element"> {{element.service}} </td>
                      </ng-container>
                      <ng-container matColumnDef="Category">
                        <th mat-header-cell *matHeaderCellDef> Category </th>
                        <td mat-cell *matCellDef="let element"> {{element.category}} </td>
                      </ng-container>
  
                      <ng-container matColumnDef="Bill Number">
                        <th mat-header-cell *matHeaderCellDef> Bill No. </th>
                        <td mat-cell *matCellDef="let element"> {{element.bill_number}} </td>
                      </ng-container>
  
  
                      <ng-container matColumnDef="Invoice">
                        <th mat-header-cell *matHeaderCellDef> Invoice No. </th>
                        <td mat-cell *matCellDef="let element"> {{element.invoice__no}} </td>
                      </ng-container>
  
  
                      <ng-container matColumnDef="Cost">
                        <th mat-header-cell *matHeaderCellDef> Cost. </th>
                        <td mat-cell *matCellDef="let element"> {{element.rate}} </td>
                      </ng-container>
  
                      <ng-container matColumnDef="Quantity">
                        <th mat-header-cell *matHeaderCellDef> Quantity </th>
                        <td mat-cell *matCellDef="let element"> {{element.quantity}} </td>
                      </ng-container>
  
  
                      <ng-container matColumnDef="Status">
                        <th mat-header-cell *matHeaderCellDef>Status</th>
                        <td mat-cell *matCellDef="let element">
  
                          <span class="badge badge-success" style="border-radius:2px;font-size:10px;"
                            *ngIf="element.status=='1'"> Fully
                            Paid</span>
                          <span class="badge badge-danger" style="border-radius:2px;font-size:10px;"
                            *ngIf="element.status=='0'"> Not
                            Paid</span>
                        </td>
                      </ng-container>
                      <ng-container matColumnDef="delete">
                          <th mat-header-cell *matHeaderCellDef> Delete </th>
                          <td mat-cell *matCellDef="let element" (click)="deleteItem(element)"><mat-icon color="warn">delete_sweep</mat-icon></td>
                        </ng-container>
                  
                      <tr mat-header-row *matHeaderRowDef="procedureColumns"></tr>
                      <tr mat-row *matRowDef="let row; columns: procedureColumns;"></tr>
                    </table>
                  </div>
                  <br>
                </div>
                <br>
              </div>

              <div class="card" id="print-section"  hidden> 
                  <div class="card-body">
                    <div class="row container-fluid">
                        <div class="col-sm-12">
                            <div class="row">
                     
                                <div class="col-sm-8">
                                    <address>
                                        <h2 style="font-family:lato light;font-weight: bolder">Kaatun Urology Center and Male Executive Clinics</h2>
                                        <span class="address" style="font-size: 18px;">
                                              <i> Parklands 3rd Avenue opposite Aga Khan Hospital</i> <br>
                                              <i > Park Medical Center,6th floor room 609</i> <br>
                                             <i> Postal address Box 15301-00100, Nairobi, Kenya</i><br>
                                            <!-- <i class="icon-call-in"></i> contact +254 7 789-1234,<br> -->
                                            <i> info@kaatun.com</i> 
                                        </span>
                                        </address>
                                </div>
                                <div class="col-sm-4">
                                    <img src="assets/img/avatars/inv_logo.jpg" style="float: right" alt="">
                                </div>
                              </div>
                        </div>
                        <div class="col-sm-12">
                          <h3 style="font-weight: bolder">INVOICE N0 : <span class="text-primary" *ngIf="patientInfo?.lab_test?.length">{{patientInfo?.lab_test[0]?.invoice__no}}</span></h3>
                        
                        </div>
                        
                          <div class="col-sm-5" style="font-size: 16px;">
                              <div class="row">
                                  <div class="col-sm-4">Type</div>
                                  <div class="col-sm-5">LAB TESTS</div>
                              </div>
                            <div class="row">
                              <div class="col-sm-4">Charge Date</div>
                              <div class="col-sm-5">{{ patientInfo?.check_in | date}}</div>
                            </div>
                            <div class="row">
                                <div class="col-sm-4">Net</div>
                                <div class="col-sm-5"><b>{{ labAmount | number:'1.2-2'}}</b></div>
                              </div>
                             
                              <div class="row">
                                  <div class="col-sm-4">Cashier</div>
                                  <div class="col-sm-5">Davi</div>
                                </div>
                          </div>
                          <div class="col-sm-5" style="font-size: 16px;">
                              <div class="row">
                                  <div class="col-sm-4" >Billed to</div>
                                  <div class="col-sm-5"><strong>{{patientInfo?.first_name | uppercase}} {{patientInfo?.other_names | uppercase}} {{patientInfo?.last_name | uppercase}}</strong></div>
                                </div>
                                <div class="row">
                                    <div class="col-sm-4">Visit number</div>
                                    <div class="col-sm-5">{{patientInfo?.visit_no}}</div>
                                  </div>
                                  <div class="row">
                                      <div class="col-sm-4">Gender</div>
                                      <div class="col-sm-5">{{patientInfo?.gender}}</div>
                                  </div>
                                <div class="row">
                                    <div class="col-sm-4">Phone</div>
                                    <div class="col-sm-5">{{patientInfo?.phone}}</div>
                                  </div>
                                  <!-- <div class="row">
                                      <div class="col-sm-4">Email</div>
                                      <div class="col-sm-5">davia@gmail.com</div>
                                  </div> -->
                            </div>
                            
                            <div class="col-sm-12">
                                <br>
                                <table class="table table-condensed" style="font-size: 16px;">  <tr> 
                                    <th>Item / Desc.</th>
                                    <th>Category.</th>
                                    <th>Bill Number.</th>
                                    <th>Qty.</th>
                                    <th>Cost</th>
                                    <th>Total</th>
                                    </tr> 
                                    <tr *ngFor="let item of patientInfo.lab_test" style="font-weight: bolder"> 
                                    <td>{{item.service}}</td>
                                    <td >{{item.category | lowercase}}</td> 
                                    <td>{{item.bill_number}}</td>
                                    <td>{{item.quantity}}</td>
                                    <td>{{item.rate | number:'1.2-2'}}</td>
                                    <td>{{item.rate * item.quantity | number:'1.2-2'}}</td> 
                                    </tr>
                
                                    <tr>
                                    <td></td>
                                    <td></td>
                                    <td></td>
                                    <td></td>
                                    <td></td>
                                    <td></td>
                                    </tr> 
                                     </table>
                
                                  </div>
                                  <div class="col-sm-4"></div>
                                  <div class="col-sm-4"></div>
                                  <div class="col-sm-4 total" style="font-size: 19px;">
                                    <div class="row">
                                      <div class="col-sm-5"> <b>SUB TOTAL </b></div>
                                      <div class="col-sm-7 text-info">{{ labAmount | number:'1.2-2' }}</div>
                                    </div>
                                    <hr>
                                    <div class="row">
                                        <div class="col-sm-5">Total Amount </div>
                                        <div class="col-sm-7">{{labAmount | number:'1.2-2'}}</div>
                                      </div>
                                      
                                      <div class="row">
                                          <div class="col-sm-5">Tax </div>
                                          <div class="col-sm-7">{{0 |number:'1.2-2'}}</div>
                                      </div>
                                      <div class="row">
                                          <div class="col-sm-5"><strong class="text-success">AMOUNT DUE</strong></div>
                                          <div class="col-sm-7"><strong>{{labAmount | number:'1.2-2'}}</strong></div>
                                        </div>
                                      
                                    
                                  </div>
                                  <div class="col-sm-12 footer">
                                    <div class="row">
                                      <div class="col-sm-6">
                                          powered by healthix uilabs
                                      </div>
                                      <div class="col-sm-6"><p class="pull-right"> <img src="../../../../assets/img/avatars/logo.png" style="height: 40px" alt=""> </p></div>
                                    </div>
                                  </div>
                                
                    </div>
                  </div>
                </div>
            </mat-tab>
  
          </mat-tab-group>
        </div>
      </div>
  
  
  
  
    </tab>
    <tab heading="Triage Details">
      <div class="row">
        <div class="col-sm-2">
            <mat-card>
                <mat-card-content>
                   <h3 align="center" class="text-primary">{{patientInfo.triage[0]?.temperature}} °C</h3>
                   <h6 align="center" style="font-size:11px">Temperature</h6>
                </mat-card-content>
             </mat-card>
        </div>
        <div class="col-sm-2">
            <mat-card>
                <mat-card-content>
                   <h3 align="center" class="text-danger">{{patientInfo.triage[0]?.blood_pressure}}</h3>
                   <h6 align="center" style="font-size:11px">Pressure</h6>
                </mat-card-content>
             </mat-card>
        </div>
        <div class="col-sm-2">
            <mat-card>
                <mat-card-content>
                   <h3 align="center" class="text-success">{{patientInfo.triage[0]?.weight}} kgs</h3>
                   <h6 align="center" style="font-size:11px">Weight</h6>
                </mat-card-content>
             </mat-card>
        </div>
        <div class="col-sm-2">
            <mat-card>
                <mat-card-content>
                   <h3 align="center" class="text-warning"> {{patientInfo.triage[0]?.height}} cm</h3>
                   <h6 align="center" style="font-size:11px">Height</h6>
                </mat-card-content>
             </mat-card>
        </div>
        <div class="col-sm-2">
            <mat-card>
                <mat-card-content>
                    <h3 align="center" class="text-success" *ngIf="patientInfo.triage[0]?.bmi < 24.9 && patientInfo.triage[0]?.bmi > 18.5">{{patientInfo.triage[0]?.bmi}}</h3>
                   <h3 align="center" class="text-danger" *ngIf="patientInfo.triage[0]?.bmi >= 24.9 || patientInfo.triage[0]?.bmi <= 18.5">{{patientInfo.triage[0]?.bmi}}</h3>
                   <h6 align="center" style="font-size:11px">BMI</h6>
                </mat-card-content>
             </mat-card>
        </div>
        <div class="col-sm-2">
            <mat-card>
                <mat-card-content>
                   <h3 align="center" class="text-primary">{{patientInfo.triage[0]?.pulse}}</h3>
                   <h6 align="center" style="font-size:11px">Pulse</h6>
                </mat-card-content>
             </mat-card>
        </div>
        
      </div>
      <br>
  <div class="row">
    <div class="col-sm-12">
      <mat-card>
          <!-- <div class="row">
              <div class="col-sm-12">
              <span style="font-weight:500;font-size:14px;">
                       |
                    Respiratory Rate <span class="text-primary">{{patientInfo.triage[0].respiratory}} bpm</span> | Pulse <span class="text-primary">{{patientInfo.triage[0].pulse}} pra</span>
              </span>
              </div>
            </div> -->
            <br>
            <div class="row">
              <div class="col-sm-6" *ngIf="patientInfo.nurse_report.observations.length">
                  <mat-card>
                      <div class="row" *ngIf="patientInfo.nurse_report.observations.length">
                          <div class="col-sm-12">
                              <h6><u>Observations</u></h6>
                          </div>
                        <div *ngFor="let item of patientInfo.nurse_report.observations" style="margin:10px;">
                            <i class="fa fa-circle text-danger" ></i> <span style="font-weight:500">{{item.name}}</span>
                        </div>
                      </div>
                      <div class="row" *ngIf="patientInfo.nurse_report.allergies.length">
                          <div class="col-sm-12">
                              <h6><u>Allergies</u></h6>
                          </div>
                            <div  *ngFor="let item of patientInfo.nurse_report.allergies" style="margin:10px;">
                                <i class="fa fa-circle text-info" ></i> <span style="font-weight:500">{{item.name}}</span>
                              </div>
                        </div>
                  </mat-card>

              </div>
              <div class="col-sm-6">
                  <div class="row">
                    <div class="col-sm-12">
                      <mat-card>
                        <mat-card-title><u class="text-success">NURSE OBSERVATIONS</u></mat-card-title>
                        <div class="row">
                            <!-- <div class="col-sm-6">
                                <span  class="obr" *ngIf="patientInfo.nurse_report?.notes[0]">OBSERVATION TYPE: <span class="text-primary" style="font-weight: 500;text-transform: capitalize;text-align: left">
                                    {{patientInfo.nurse_report?.notes[0]?.observation_type}}
                                </span></span>
                                
                            </div> -->
                            <div class="col-sm-6">
                                <div class="row" *ngIf="patientInfo.nurse_report?.notes[0]?.symptoms_onset">
                                    <div class="col-sm-5">
                                        SYMPTOMS ONSET
                                    </div>
                                    <div class="col-sm-7 text-primary" >{{patientInfo.nurse_report?.notes[0]?.symptoms_onset | date:'yyyy-MM-dd'}}</div>
                                  </div>
                            </div>
                        </div>
                         <div class="row">
                           <div class="col-sm-6 obr ">
                             <div class="row">
                               <div class="col-sm-5">
                                RISK OF FALL
                               </div>
                               <div class="col-sm-7 text-danger" >{{patientInfo.triage[0].risk_of_fall}}</div>
                             </div>
                           </div>
                           <div class="col-sm-6 obr">
                              <div class="row">
                                  <div class="col-sm-5">
                                   PAIN LEVEL
                                  </div>
                                  <div class="col-sm-7 text-danger">{{patientInfo.triage[0].pain_level}}</div>
                                </div>
                           </div>
                         </div>
                          <div class="row" style="margin-top: 5px">
                              <div class="col-sm-12" *ngIf="patientInfo.nurse_report?.notes[0]?.notes">
                              <mat-form-field>
                                <input type="text" matInput placeholder="NURSE NOTES" value="{{patientInfo.nurse_report?.notes[0]?.notes}}">
                              </mat-form-field>
                                
                              </div>
                          </div>
                      </mat-card>
                    </div>
                  </div>
              </div>
            </div>
             
          <br>
          <div class="row">
            <div class="col-sm-4">
              <fusioncharts [width]="300" [height]="270" [type]="type" [dataFormat]="dataFormat" [dataSource]="dataSource">
              </fusioncharts>
            </div>
    
            <div class="col-sm-4">
              <fusioncharts width="450" height="250" type="AngularGauge" [dataSource]="pressureSource">
              </fusioncharts>
            </div>
            <div class="col-sm-4">
              <fusioncharts width="300" height="270" type="Column2D" dataFormat="JSON" [dataSource]="tempSource">
              </fusioncharts>
            </div>
          </div>
      </mat-card>
    </div>
  </div>
    </tab>
  
    <tab heading="Treatment">
  
      <tabset>
        <tab>
  
          <ng-template tabHeading><b class="tab-headers"><i
                class="icon-plus"></i> Diagnosis</b></ng-template>
          <div class="row">
            <div class="col-sm-3">
              <mat-form-field>
                  <input type="text"  placeholder="Diagnosis" name="diagnosis"
                  [(ngModel)]="selectedOption.description" typeaheadOptionField="description" [typeahead]="diagnosesList"
                  (typeaheadOnSelect)="onDiagnosis($event)" [typeaheadOptionsLimit]="12" (keyup.enter)="addUnavailable()" (typeaheadLoading)="searchDiagnosis(selectedOption.description)" matInput>
                  <i class="icon-magnifier-add" matSuffix></i>
                  <button mat-button *ngIf="selectedOption.description" matSuffix mat-icon-button aria-label="Clear" (click)="selectedOption.description=''">
                      <mat-icon>close</mat-icon>
                    </button>
              </mat-form-field>
            </div>
            <div class="col-sm-4"></div>
            <div class="col-sm-4">
              <mat-form-field >
                <input matInput placeholder="Added Observations" [(ngModel)]="observation.observations">
              </mat-form-field>
            </div>
            <div class="col-sm-1">
              <button mat-mini-fab (click)="addObservation()"> <i class="fa fa-plus"></i> </button>
            </div>
          </div>
          <br />
         <mat-card>
            <div class="row">
                <div class="col-sm-12">
                    <div class="mat-elevation-z8">
                        <table mat-table [dataSource]="diagnosisList">
                            <ng-container matColumnDef="Sn">
                                <th mat-header-cell *matHeaderCellDef>S/No</th>
                                <td mat-cell *matCellDef="let element; let i = index;"> {{i+1}} </td>
                              </ng-container>
                          <ng-container matColumnDef="Diagnosis">
                            <th mat-header-cell *matHeaderCellDef>Diagnosis</th>
                            <td mat-cell *matCellDef="let element"> {{element.description}} </td>
                          </ng-container>
      
                          <ng-container matColumnDef="Code">
                            <th mat-header-cell *matHeaderCellDef>Code</th>
                            <td mat-cell *matCellDef="let element"> {{element.code}} </td>
                          </ng-container>
                          <ng-container matColumnDef="Primary">
                            <th mat-header-cell *matHeaderCellDef>Primary</th>
                            <td mat-cell *matCellDef="let element"><mat-checkbox (click)="updateDiagnosis(element)" [checked]="element.primary"></mat-checkbox></td>
                          </ng-container>
                          <ng-container matColumnDef="delete">
                        <th mat-header-cell *matHeaderCellDef>Delete</th>
                        <td mat-cell *matCellDef="let element" (click)="delDiagnosis(element)"> <mat-icon color="warn">delete_sweep</mat-icon></td>
                      </ng-container>
                          <tr mat-header-row *matHeaderRowDef="diagnosisColumns"></tr>
                          <tr mat-row *matRowDef="let row; columns: diagnosisColumns"></tr>
                        </table>
      
                      </div>
                </div>
              </div>
         </mat-card>
          <br>
          <mat-card *ngIf="patientInfo?.doctor_notes?.length">
            <mat-card-subtitle>Observations</mat-card-subtitle>
            <div class="row">
              <div class="col-sm-12">
                <table mat-table [dataSource]="patientInfo?.doctor_notes" class="mat-elevation-z8">
                  <ng-container matColumnDef="sn">
                    <th mat-header-cell *matHeaderCellDef> No. </th>
                    <td mat-cell *matCellDef="let element;let i = index"> {{i+1}} </td>
                  </ng-container>
                
                  <ng-container matColumnDef="observation">
                    <th mat-header-cell *matHeaderCellDef>Observation</th>
                    <td mat-cell *matCellDef="let element"> {{element.observations}} </td>
                  </ng-container>
        
                  <ng-container matColumnDef="created">
                    <th mat-header-cell *matHeaderCellDef>Created</th>
                    <td mat-cell *matCellDef="let element"> {{element.created | date:'yyyy-MM-dd'}} </td>
                  </ng-container>
                  <ng-container matColumnDef="visit_no">
                    <th mat-header-cell *matHeaderCellDef>Visit Number</th>
                    <td mat-cell *matCellDef="let element"> {{element.visit__visit_no}} </td>
                  </ng-container>
                  <ng-container matColumnDef="doctor">
                    <th mat-header-cell *matHeaderCellDef>Doctor</th>
                    <td mat-cell *matCellDef="let element"> {{element.doctor__username | uppercase}} </td>
                  </ng-container>
  
                  <ng-container matColumnDef="delete">
                    <th mat-header-cell *matHeaderCellDef>Delete</th>
                    <td mat-cell *matCellDef="let element" (click)="deleteNote(element)"> <mat-icon color="warn">delete_sweep</mat-icon></td>
                  </ng-container>
                
                  <tr mat-header-row *matHeaderRowDef="observationsColumns"></tr>
                  <tr mat-row *matRowDef="let row; columns: observationsColumns;"></tr>
                </table>
                
              </div>
            </div>
          </mat-card>
          <br />
        </tab>
        <tab>
          <ng-template tabHeading><b class="tab-headers" ><i
                class="icon-plus"></i> Procedures</b></ng-template>
               
                <div class="row">
                    <div class="col-md-12">
                        <div class="row">
                            <div class="col-sm-3">
                              <mat-form-field>
                                
                                <input type="text" matInput (typeaheadOnSelect)="onSelect($event)" name="test"
                                placeholder="Procedure" typeaheadOptionField="name" [(ngModel)]="selectedOption.name"
                                [typeahead]="services" [typeaheadOptionsLimit]="7"
                                (typeaheadLoading)="searchProcedure(selectedOption.name)">
                                <button mat-button *ngIf="selectedOption.name" matSuffix mat-icon-button aria-label="Clear" (click)="selectedOption.name=''">
                                    <mat-icon>close</mat-icon>
                                  </button>
                              </mat-form-field>
                            </div>
                            <div class="col-sm-2">
                               <mat-form-field>
                                 <input type="text" matInput  [(ngModel)]="selectedOption.cost" placeholder="Cost" readonly>
                               </mat-form-field>
                             </div>
                            <!-- <div class="col-sm-2">
                               <mat-form-field>
                                 <input type="text" matInput  [(ngModel)]="selectedOption.date" placeholder="Sugery Date" bsDatepicker>
                               </mat-form-field>
                             </div>
                             <div class="col-sm-2">
                                 <mat-form-field>
                                   <input type="text" matInput  [(ngModel)]="selectedOption.surgeon" placeholder="Surgeon Name">
                                   <button mat-button *ngIf="selectedOption.surgeon" matSuffix mat-icon-button aria-label="Clear" (click)="selectedOption.surgeon=''">
                                      <mat-icon>close</mat-icon>
                                    </button>
                                 </mat-form-field>
                               </div>
                               <div class="col-sm-2">
                                   <mat-form-field>
                                     <input type="text" matInput  [(ngModel)]="selectedOption.assistant" placeholder="Assistant Surgeon Name">
                                     <button mat-button *ngIf="selectedOption.assistant" matSuffix mat-icon-button aria-label="Clear" (click)="selectedOption.assistant=''">
                                        <mat-icon>close</mat-icon>
                                      </button>
                                   </mat-form-field>
                                 </div> -->
                                 <div class="col-sm-1">
                                    <button class="btn btn-success btn-sm" mat-mini-fab color="accent" (click)="saveService()"> <i class="fa fa-plus"></i></button>

                                 </div>
                      </div>
                    </div>
                  </div>
        
          <br />
          <div class="row">
            <div class="col-md-12">
              <div class="mat-elevation-z8">
                <table mat-table [dataSource]="data">
                    <ng-container matColumnDef="Sn">
                        <th mat-header-cell *matHeaderCellDef>S/No</th>
                        <td mat-cell *matCellDef="let element;let i = index"> {{i+1}} </td>
                      </ng-container>
                  <ng-container matColumnDef="Procedure">
                    <th mat-header-cell *matHeaderCellDef> Procedure. </th>
                    <td mat-cell *matCellDef="let element"> {{element.service}} </td>
                  </ng-container>
                  <ng-container matColumnDef="Category">
                    <th mat-header-cell *matHeaderCellDef> Category </th>
                    <td mat-cell *matCellDef="let element"> {{element.category}} </td>
                  </ng-container>
  
                  <ng-container matColumnDef="Bill Number">
                    <th mat-header-cell *matHeaderCellDef> Bill Number </th>
                    <td mat-cell *matCellDef="let element"> {{element.bill_number}} </td>
                  </ng-container>
  
  
                  <ng-container matColumnDef="Invoice">
                    <th mat-header-cell *matHeaderCellDef> Invoice Number </th>
                    <td mat-cell *matCellDef="let element"> {{element.invoice__no}} </td>
                  </ng-container>
  
  
                  <ng-container matColumnDef="Cost">
                    <th mat-header-cell *matHeaderCellDef> Cost </th>
                    <td mat-cell *matCellDef="let element"> {{element.rate | number:'1.2-2'}} </td>
                  </ng-container>
  
                  <ng-container matColumnDef="Quantity">
                    <th mat-header-cell *matHeaderCellDef> Quantity </th>
                    <td mat-cell *matCellDef="let element"> {{element.quantity}} </td>
                  </ng-container>
  
  
                  <ng-container matColumnDef="Status">
                    <th mat-header-cell *matHeaderCellDef>Status</th>
                    <td mat-cell *matCellDef="let element">
  
                      <span class="badge badge-success" style="border-radius:2px;font-size:10px;"
                        *ngIf="element.status=='1'"> Fully
                        Paid</span>
                      <span class="badge badge-danger" style="border-radius:2px;font-size:10px;"
                        *ngIf="element.status=='0'"> Not
                        Paid</span>
                    </td>
                  </ng-container>
                  <ng-container matColumnDef="delete">
                      <th mat-header-cell *matHeaderCellDef> Delete </th>
                      <td mat-cell *matCellDef="let element" (click)="deleteItem(element)"><mat-icon color="warn">delete_sweep</mat-icon></td>
                    </ng-container>
                  <tr mat-header-row *matHeaderRowDef="procedureColumns"></tr>
                  <tr mat-row *matRowDef="let row; columns: procedureColumns;"></tr>
                </table>
              </div>
            </div>
          </div>
          <br>
        </tab>
        <tab>
          <ng-template tabHeading><b class="tab-headers"><i
                class="icon-plus"></i> LabTest</b></ng-template>
          <div class="row">
            <div class="col-sm-3">
              <mat-form-field>
                  <input matInput [(ngModel)]="selectedTest.name" [typeahead]="tests" (typeaheadOnSelect)="OnSelectTest($event)"
                  [typeaheadOptionsLimit]="7" typeaheadOptionField="name" placeholder="Lab Test" 
                  name="labtest" type="text" (typeaheadLoading)="searchTest(selectedTest.name)">
                  <button mat-button *ngIf="selectedTest.name" matSuffix mat-icon-button aria-label="Clear" (click)="selectedTest.name=''">
                      <mat-icon>close</mat-icon>
                    </button>
              </mat-form-field>
            </div>
          </div>
          <div class="row">
                        <div class="col-sm-12">
                          <div  class="mat-elevation-z8">
                            <table mat-table [dataSource]="patientInfo.lab_test" >
                                <ng-container matColumnDef="Sn">
                                    <th mat-header-cell *matHeaderCellDef>S/No</th>
                                    <td mat-cell *matCellDef="let element;let i = index"> {{i+1}} </td>
                                  </ng-container>
                              <ng-container matColumnDef="Procedure">
                                <th mat-header-cell *matHeaderCellDef> Lab Test. </th>
                                <td mat-cell *matCellDef="let element"> {{element.service}} </td>
                              </ng-container>
                              <ng-container matColumnDef="Category">
                                <th mat-header-cell *matHeaderCellDef> Category </th>
                                <td mat-cell *matCellDef="let element"> {{element.category}} </td>
                              </ng-container>
                        
                              <ng-container matColumnDef="Bill Number">
                                <th mat-header-cell *matHeaderCellDef> Bill No. </th>
                                <td mat-cell *matCellDef="let element"> {{element.bill_number}} </td>
                              </ng-container>
                        
                        
                              <ng-container matColumnDef="Invoice">
                                <th mat-header-cell *matHeaderCellDef> Invoice No. </th>
                                <td mat-cell *matCellDef="let element"> {{element.invoice__no}} </td>
                              </ng-container>
                        
                        
                              <ng-container matColumnDef="Cost">
                                <th mat-header-cell *matHeaderCellDef> Cost. </th>
                                <td mat-cell *matCellDef="let element"> {{element.rate}} </td>
                              </ng-container>
                        
                              <ng-container matColumnDef="Quantity">
                                <th mat-header-cell *matHeaderCellDef> Quantity </th>
                                <td mat-cell *matCellDef="let element"> {{element.quantity}} </td>
                              </ng-container>
                        
                        
                              <ng-container matColumnDef="Status">
                                <th mat-header-cell *matHeaderCellDef>Status</th>
                                <td mat-cell *matCellDef="let element">
                        
                                  <span class="badge badge-success" style="border-radius:2px;font-size:10px;" *ngIf="element.status=='1'"> Fully
                                    Paid</span>
                                  <span class="badge badge-danger" style="border-radius:2px;font-size:10px;" *ngIf="element.status=='0'"> Not
                                    Paid</span>
                                </td>
                              </ng-container>
                              <ng-container matColumnDef="delete">
                                  <th mat-header-cell *matHeaderCellDef> Delete </th>
                                  <td mat-cell *matCellDef="let element" (click)="deleteItem(element)"><mat-icon color="warn">delete_sweep</mat-icon></td>
                                </ng-container>
                          
                              <tr mat-header-row *matHeaderRowDef="procedureColumns"></tr>
                              <tr mat-row *matRowDef="let row; columns: procedureColumns;"></tr>
                            </table>
                          </div>
                        </div>
          </div>
  
          <br />
      
        </tab>
  
        <tab>
          <ng-template tabHeading><b class="tab-headers"><i
                class="icon-plus"></i> Prescription</b></ng-template>
               <div class="row">
                 <div class="col-sm-12">
                    <div class="row">
                        <div class="col-sm-3">
                          <mat-form-field>
                            
                            <input type="text" matInput placeholder="Prescription" [(ngModel)]="selectedDrug.name" [typeahead]="drugs"
                            [typeaheadOptionsInScrollableView]="5" typeaheadOptionField="name" (typeaheadLoading)="searchPrescription(selectedDrug.name)"
                            (typeaheadOnSelect)="onDrug($event)" placeholder="Prescription Name"
                            typeaheadGroupField="strength">
                            <button mat-button *ngIf="selectedDrug.name" matSuffix mat-icon-button aria-label="Clear" (click)="selectedDrug.name=''">
                                <mat-icon>close</mat-icon>
                              </button>
                          </mat-form-field>
                        </div>
                        <div class="col-sm-3">
                          <mat-form-field>
                            <input type="text" matInput [(ngModel)]="selectedDrug.cost" placeholder="Cost" readonly>
                          </mat-form-field>
                        </div>
                        <div class="col-sm-2">
                            <mat-form-field>
                              <input type="text" matInput [(ngModel)]="selectedDrug.form" placeholder="Drug Form">
                            </mat-form-field>
                          </div>
                          <div class="col-sm-2">
                              <mat-form-field>
                                <input type="text" matInput [(ngModel)]="selectedDrug.strength" placeholder="Strength" readonly>
                              </mat-form-field>
                            </div>
                            <div class="col-sm-2">
                                <mat-form-field>
                                    <mat-label>Dosage</mat-label>
                                    <mat-select [(ngModel)]="selectedDrug.dosage">
                                      <mat-option *ngFor="let item of dosage" [value]="item.meaning">
                                        {{item.meaning}}
                                      </mat-option>
                                    </mat-select>
                                  </mat-form-field>
                            </div>
                        </div>
                        <div class="row">
                           
                            <div class="col-sm-2">
                              <mat-form-field>
                                <input type="text" matInput [(ngModel)]="selectedDrug.route" placeholder="Route">
                                <button mat-button *ngIf="selectedDrug.route" matSuffix mat-icon-button aria-label="Clear" (click)="selectedDrug.route=''">
                                    <mat-icon>close</mat-icon>
                                  </button>
                              </mat-form-field>
                            </div>
                            
                              <div class="col-sm-2">
                                  <mat-form-field>
                                      <mat-label>Frequency</mat-label>
                                      <mat-select [(ngModel)]="selectedDrug.frequency">
                                        <mat-option *ngFor="let item of frequencies" [value]="item" >
                                          {{item}}
                                        </mat-option>
                                      </mat-select>
                                    </mat-form-field>
                              </div>
                              <div class="col-sm-2">
                                  <mat-form-field>
                                    <input type="number" matInput [(ngModel)]="selectedDrug.duration" placeholder="Duration(days)">
                                    <button mat-button *ngIf="selectedDrug.duration" matSuffix mat-icon-button aria-label="Clear" (click)="selectedDrug.duration=''">
                                        <mat-icon>close</mat-icon>
                                      </button>
                                  </mat-form-field>
                                </div>
                              <div class="col-sm-2">
                                  <mat-form-field>
                                    <input type="text" matInput [(ngModel)]="selectedDrug.medication_schedule" placeholder="Medication Schedule">
                                    <button mat-button *ngIf="selectedDrug.medication_schedule" matSuffix mat-icon-button aria-label="Clear" (click)="selectedDrug.medication_schedule=''">
                                        <mat-icon>close</mat-icon>
                                      </button>
                                  </mat-form-field>
                                </div>
                                <div class="col-sm-2">
                                  <mat-form-field>
                                    <input type="number" matInput [(ngModel)]="selectedDrug.load" placeholder="Quantity">
                                    <button mat-button *ngIf="selectedDrug.load" matSuffix mat-icon-button aria-label="Clear" (click)="selectedDrug.load=''">
                                        <mat-icon>close</mat-icon>
                                      </button>
                                  </mat-form-field>
                                </div>
                                <div class="col-sm-2">
                                    <mat-form-field >
                                      <input type="number" matInput [(ngModel)]="selectedDrug.refils" placeholder="Refils">
                                      <button mat-button *ngIf="selectedDrug.refils" matSuffix mat-icon-button aria-label="Clear" (click)="selectedDrug.refils=''">
                                          <mat-icon>close</mat-icon>
                                        </button>
                                    </mat-form-field>
                                  </div>
                              <br>
                              <div class="col-sm-12" >
                                <mat-form-field appearance="outline">
                                  <mat-label>Notes</mat-label>
                                  <textarea name="notes" [(ngModel)]="selectedDrug.notes"  rows="3" matInput></textarea>
                                </mat-form-field>
                              </div>
                            </div>
                            <div class="row">
                              <div class="col-sm-12">
                                  <button class="btn btn-success btn-sm pull-right" (click)="savePrescription()"> <i class="icon-check"></i> Submit</button>
                              </div>
                            </div>
                 </div>
               </div>
             
              <br>  
          <div class="row" *ngIf="patientInfo.prescription.length">
            <div class="col-sm-12" >
              <div class="mat-elevation-z8">
                <table mat-table [dataSource]="prescriptions" >
                    <ng-container matColumnDef="generic_name">
                        <th mat-header-cell *matHeaderCellDef>Generic Name</th>
                        <td mat-cell *matCellDef="let element"> {{element.generic_name}} </td>
                      </ng-container>
                  <ng-container matColumnDef="name">
                    <th mat-header-cell *matHeaderCellDef>Brand Name</th>
                    <td mat-cell *matCellDef="let element"> {{element.name}} </td>
                  </ng-container>
                  
                  <ng-container matColumnDef="dosage">
                    <th mat-header-cell *matHeaderCellDef>Dosage</th>
                    <td mat-cell *matCellDef="let element"> {{element.dosage}} </td>
                  </ng-container>
                  <ng-container matColumnDef="frequency">
                    <th mat-header-cell *matHeaderCellDef>Frequency</th>
                    <td mat-cell *matCellDef="let element"> {{element.frequency}} </td>
                  </ng-container>
                  <ng-container matColumnDef="duration">
                    <th mat-header-cell *matHeaderCellDef>Duration</th>
                    <td mat-cell *matCellDef="let element"> {{element.duration}} </td>
                  </ng-container>
  
                  <ng-container matColumnDef="route">
                    <th mat-header-cell *matHeaderCellDef> Route </th>
                    <td mat-cell *matCellDef="let element"> {{element.route}} </td>
                  </ng-container>
                  <ng-container matColumnDef="notes">
                      <th mat-header-cell *matHeaderCellDef>Notes </th>
                      <td mat-cell *matCellDef="let element"> {{element.notes }} </td>
                    </ng-container>
                    <ng-container matColumnDef="form">
                        <th mat-header-cell *matHeaderCellDef>Form</th>
                        <td mat-cell *matCellDef="let element"> {{element.form}}</td>
                      </ng-container>
                      <ng-container matColumnDef="delete">
                          <th mat-header-cell *matHeaderCellDef> Delete </th>
                          <td mat-cell *matCellDef="let element" (click)="deleteItem(element)"><mat-icon color="warn">delete_sweep</mat-icon></td>
                        </ng-container>
                  <tr mat-header-row *matHeaderRowDef="drugColumns"></tr>
                  <tr mat-row *matRowDef="let row; columns: drugColumns"></tr>
                </table>
              </div>
            </div>
          </div>

        </tab>
      </tabset>
    </tab>
  </tabset>
</div>

<ngx-loading [show]="loading" [config]="{ backdropBorderRadius: '9px' }"></ngx-loading>